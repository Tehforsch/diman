#!/bin/bash

diff=$(cargo fmt -- --check)
result=$?

if [[ ${result} -ne 0 ]] ; then
    cat <<\EOF
There are some code style issues, run `cargo fmt` first.
EOF
fi

for glam in glam,glam-vec2,glam-dvec2,glam-vec3,glam-dvec3, "" ; do
    echo cargo test --no-default-features --features "${dim}${float}${glam},mpi,rand,serde,hdf5"
    if ! cargo test --no-default-features --features "${dim}${float}${glam},mpi,rand,serde,hdf5"
    then
        echo "There are some test issues."
        exit 1
    fi
done

exit 0

diff=$(cargo fmt -- --check)
result=$?

if [[ ${result} -ne 0 ]] ; then
    cat <<\EOF
There are some code style issues, run `cargo fmt` first.
EOF
    exit 1
fi
